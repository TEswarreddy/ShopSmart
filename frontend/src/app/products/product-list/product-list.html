<section class="mb-4">
	<h2 class="h4">Products</h2>
	<input
		class="form-control"
		type="text"
		[value]="search"
		(input)="onSearch($any($event.target).value)"
		placeholder="Search by title or category"
	/>
</section>

@if (loading) {
	<p>Loading products...</p>
}

@if (!loading && error) {
	<div class="alert alert-danger" role="alert">{{ error }}</div>
}

@if (!loading && !error && filteredProducts.length === 0) {
	<p>No products found.</p>
}

@if (!loading && !error && filteredProducts.length > 0) {
	<div class="row g-3">
		@for (item of filteredProducts; track item._id) {
			<div class="col-12 col-md-6 col-lg-4">
				<div class="card h-100">
					@if (item.image) {
						<img [src]="item.image" class="card-img-top product-image" [alt]="item.title" />
					}
					<div class="card-body d-flex flex-column">
						<h3 class="h6">{{ item.title }}</h3>
						<p class="text-muted small mb-2">{{ item.category || 'General' }}</p>
						<p class="fw-semibold mb-3">â‚¹{{ item.price }}</p>
						<div class="mt-auto d-flex gap-2">
							<a class="btn btn-outline-secondary btn-sm" [routerLink]="['/products', item._id]">
								View
							</a>
							<button class="btn btn-dark btn-sm" type="button" (click)="addToCart(item)">
								Add to cart
							</button>
						</div>
					</div>
				</div>
			</div>
		}
	</div>
}
