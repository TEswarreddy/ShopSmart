<div class="app-shell" id="top">
	<header class="amazon-header">
		<div class="header-main container-fluid">
			<a class="logo" routerLink="/" (click)="closeMenu()">ShopSmart</a>

			<div class="delivery-info d-none d-md-flex">
				<span class="small-label">Deliver to</span>
				<strong>India</strong>
			</div>

			<div class="search-wrap" role="search" aria-label="Search products">
				<input class="search-input" type="text" placeholder="Search ShopSmart" />
				<button class="search-btn" type="button">Search</button>
			</div>

			<button
				class="menu-btn"
				type="button"
				[attr.aria-expanded]="isMenuOpen"
				aria-label="Toggle navigation"
				(click)="toggleMenu()"
			>
				☰
			</button>

			<nav class="utility-nav d-none d-lg-flex">
				@if (authService.user(); as user) {
					@if (user.role !== 'user') {
						<a class="utility-link" [routerLink]="dashboardRoute()" (click)="closeMenu()">
							<span class="small-label">Hello, {{ user.name }}</span>
							<strong>{{ roleLabel(user.role) }} Account</strong>
						</a>
					}
				} @else {
					<a class="utility-link" routerLink="/login/user" (click)="closeMenu()">
						<span class="small-label">Hello, sign in</span>
						<strong>User Account</strong>
					</a>
				}
				<a class="utility-link" [routerLink]="orderHistoryRoute()" (click)="closeMenu()">
					<span class="small-label">Returns</span>
					<strong>& Orders</strong>
				</a>
				@if (authService.isLoggedIn()) {
					<a class="utility-link" routerLink="/profile" (click)="closeMenu()">
						<span class="small-label">Manage</span>
						<strong>Profile</strong>
					</a>
				}
				@if (canAccessUserCommerce()) {
					<a class="utility-link cart-link" routerLink="/cart" routerLinkActive="active" (click)="closeMenu()">
						Cart <span class="cart-badge">{{ cartService.totalItems() }}</span>
					</a>
					<a class="utility-link" routerLink="/checkout" (click)="closeMenu()">
						<span class="small-label">Secure</span>
						<strong>Checkout</strong>
					</a>
				}
				@if (authService.isLoggedIn()) {
					<button class="utility-action" type="button" (click)="logout()">Logout</button>
				} @else {
					<a class="utility-action" routerLink="/register/user" (click)="closeMenu()">Register</a>
				}
			</nav>
		</div>

		<div class="header-sub">
			<div class="container sub-inner" [class.open]="isMenuOpen">
				<a class="sub-link" routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }" (click)="closeMenu()">All Products</a>
				@if (authService.isLoggedIn()) {
					@if (canAccessDashboard()) {
						<a class="sub-link" [routerLink]="dashboardRoute()" routerLinkActive="active" (click)="closeMenu()">Dashboard</a>
					}
					<a class="sub-link" [routerLink]="orderHistoryRoute()" routerLinkActive="active" (click)="closeMenu()">Orders</a>
					<a class="sub-link" routerLink="/profile" routerLinkActive="active" (click)="closeMenu()">Profile</a>
				}
				@if (canAccessUserCommerce()) {
					<a class="sub-link" routerLink="/cart" routerLinkActive="active" (click)="closeMenu()">Your Cart</a>
					<a class="sub-link" routerLink="/checkout" routerLinkActive="active" (click)="closeMenu()">Checkout</a>
				}
				@if (!authService.isLoggedIn()) {
					<a class="sub-link" routerLink="/login/user" routerLinkActive="active" (click)="closeMenu()">Sign In</a>
					<a class="sub-link" routerLink="/register/user" routerLinkActive="active" (click)="closeMenu()">Register</a>
				}
				<a class="sub-link" routerLink="/deals" routerLinkActive="active" (click)="closeMenu()">Today's Deals</a>
				<a class="sub-link" routerLink="/support" routerLinkActive="active" (click)="closeMenu()">Customer Service</a>
				@if (authService.isLoggedIn()) {
					<button class="sub-link sub-btn" type="button" (click)="logout()">Logout</button>
				}
			</div>
		</div>
	</header>

	<main class="container py-4 flex-grow-1">
		<router-outlet></router-outlet>
	</main>

	<footer class="amazon-footer mt-4">
		<a href="#top" class="back-top">Back to top</a>

		<div class="footer-columns container">
			<div>
				<h2>Get to Know Us</h2>
				<a routerLink="/about-us">About ShopSmart</a>
				<a routerLink="/careers">Careers</a>
				<a routerLink="/contact">Press Releases</a>
			</div>
			<div>
				<h2>Make Money with Us</h2>
				<a routerLink="/sell">Sell on ShopSmart</a>
				<a routerLink="/advertise">Advertise Products</a>
				<a routerLink="/affiliate">Affiliate Program</a>
			</div>
			<div>
				<h2>Help</h2>
				<a routerLink="/help">Payments</a>
				<a routerLink="/help">Shipping</a>
				<a routerLink="/help">Returns</a>
			</div>
		</div>

		<div class="footer-bottom">
			<span>© {{ currentYear }} ShopSmart</span>
		</div>
	</footer>
</div>